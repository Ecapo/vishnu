\hypertarget{classTorqueServer}{
\section{TorqueServer Class Reference}
\label{classTorqueServer}\index{TorqueServer@{TorqueServer}}
}


\hyperlink{classTorqueServer}{TorqueServer} class implementation.  




{\ttfamily \#include $<$TorqueServer.hpp$>$}

Inheritance diagram for TorqueServer:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classTorqueServer}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classTorqueServer_a1537f6573e0996608ea317264ecb02e9}{
\hyperlink{classTorqueServer_a1537f6573e0996608ea317264ecb02e9}{TorqueServer} ()}
\label{classTorqueServer_a1537f6573e0996608ea317264ecb02e9}

\begin{DoxyCompactList}\small\item\em Constructor. \item\end{DoxyCompactList}\item 
int \hyperlink{classTorqueServer_aed03b8755d1959b3a2218abbf4c15b45}{submit} (const char $\ast$scriptPath, const TMS\_\-Data::SubmitOptions \&options, TMS\_\-Data::Job \&job, char $\ast$$\ast$envp=NULL)
\begin{DoxyCompactList}\small\item\em Function to submit Torque job. \item\end{DoxyCompactList}\item 
int \hyperlink{classTorqueServer_a18f3c5c500957a5a14f64f3c34252ae5}{cancel} (const char $\ast$jobId)
\begin{DoxyCompactList}\small\item\em Function to cancel job. \item\end{DoxyCompactList}\item 
int \hyperlink{classTorqueServer_ab86efdba2c40900e858ebf9f687ad05b}{getJobState} (const std::string \&jobId)
\begin{DoxyCompactList}\small\item\em Function to get the status of the job. \item\end{DoxyCompactList}\item 
time\_\-t \hyperlink{classTorqueServer_accebe9545525e72a67d3c684665c9264}{getJobStartTime} (const std::string \&jobId)
\begin{DoxyCompactList}\small\item\em Function to get the start time of the job. \item\end{DoxyCompactList}\item 
TMS\_\-Data::ListQueues $\ast$ \hyperlink{classTorqueServer_a63240dcd85082bb88ee157a8da8f6a04}{listQueues} (const std::string \&optQueueName=std::string())
\begin{DoxyCompactList}\small\item\em Function to request the status of queues. \item\end{DoxyCompactList}\item 
\hypertarget{classTorqueServer_a1f6d05661fd240d68e0ef7bf92f54092}{
\hyperlink{classTorqueServer_a1f6d05661fd240d68e0ef7bf92f54092}{$\sim$TorqueServer} ()}
\label{classTorqueServer_a1f6d05661fd240d68e0ef7bf92f54092}

\begin{DoxyCompactList}\small\item\em Destructor. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classTorqueServer_a8f155d04ceea433de756c98225c053b8}{pbs\_\-cancel} (const char $\ast$jobId, char remoteServer\mbox{[}$\,$\mbox{]}, bool isLocal=true)
\begin{DoxyCompactList}\small\item\em Function to cancel job on remote machine. \item\end{DoxyCompactList}\item 
void \hyperlink{classTorqueServer_a8c8357ec45741351b28891a01fd52a3b}{processOptions} (const char $\ast$scriptPath, const TMS\_\-Data::SubmitOptions \&options, std::vector$<$ std::string $>$ \&cmdsOptions)
\begin{DoxyCompactList}\small\item\em Function to treat the submission options. \item\end{DoxyCompactList}\item 
int \hyperlink{classTorqueServer_a5fb51c751187a2bd49598aee2b0e3b18}{convertTorqueStateToVishnuState} (std::string state)
\begin{DoxyCompactList}\small\item\em Function to convert the Torque state into VISHNU state. \item\end{DoxyCompactList}\item 
int \hyperlink{classTorqueServer_a2427d2d3c69cf28f779d22396383e4d4}{convertTorquePrioToVishnuPrio} (const int \&prio)
\begin{DoxyCompactList}\small\item\em Function to convert the Torque priority into VISHNU priority. \item\end{DoxyCompactList}\item 
void \hyperlink{classTorqueServer_a0411b4c5d842efabc66e9a5db39cceba}{fillJobInfo} (TMS\_\-Data::Job \&job, struct batch\_\-status $\ast$p)
\begin{DoxyCompactList}\small\item\em Function To fill the info concerning a job. \item\end{DoxyCompactList}\item 
int \hyperlink{classTorqueServer_a3abd12ff06eb1774669d03b3f6f85f22}{getNbNodesInNodeFormat} (const std::string \&format, int \&nbCpu)
\begin{DoxyCompactList}\small\item\em Function to get the number of nodes in the torque node format. \item\end{DoxyCompactList}\item 
std::string \hyperlink{classTorqueServer_aa43c09a2a522df515a6b0b4334ed96d8}{getFormatedCpuPerNode} (const int \&cpu, const std::string \&scriptPath)
\begin{DoxyCompactList}\small\item\em Function to get the torque formated cpu per node. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classTorqueServer_ada6a31f5672ecf7297dfac26ed62e19a}{
TMS\_\-Data::ListQueues\_\-ptr \hyperlink{classTorqueServer_ada6a31f5672ecf7297dfac26ed62e19a}{mlistQueues}}
\label{classTorqueServer_ada6a31f5672ecf7297dfac26ed62e19a}

\begin{DoxyCompactList}\small\item\em ListQueues returned. \item\end{DoxyCompactList}\item 
\hypertarget{classTorqueServer_ae798d6ea4f01fc4336756a0cba5a644c}{
char \hyperlink{classTorqueServer_ae798d6ea4f01fc4336756a0cba5a644c}{serverOut} \mbox{[}PBS\_\-MAXSERVERNAME+PBS\_\-MAXPORTNUM+2\mbox{]}}
\label{classTorqueServer_ae798d6ea4f01fc4336756a0cba5a644c}

\begin{DoxyCompactList}\small\item\em The name of the server to connect. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
\hyperlink{classTorqueServer}{TorqueServer} class implementation. 

\subsection{Member Function Documentation}
\hypertarget{classTorqueServer_a18f3c5c500957a5a14f64f3c34252ae5}{
\index{TorqueServer@{TorqueServer}!cancel@{cancel}}
\index{cancel@{cancel}!TorqueServer@{TorqueServer}}
\subsubsection[{cancel}]{\setlength{\rightskip}{0pt plus 5cm}int TorqueServer::cancel (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{jobId}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classTorqueServer_a18f3c5c500957a5a14f64f3c34252ae5}


Function to cancel job. 


\begin{DoxyParams}{Parameters}
{\em jobId} & the identifier of the job to cancel \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
raises an exception on error 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_af40bbd83fa2bd1f1720e29800227cdb0}{BatchServer}.

\hypertarget{classTorqueServer_a2427d2d3c69cf28f779d22396383e4d4}{
\index{TorqueServer@{TorqueServer}!convertTorquePrioToVishnuPrio@{convertTorquePrioToVishnuPrio}}
\index{convertTorquePrioToVishnuPrio@{convertTorquePrioToVishnuPrio}!TorqueServer@{TorqueServer}}
\subsubsection[{convertTorquePrioToVishnuPrio}]{\setlength{\rightskip}{0pt plus 5cm}int TorqueServer::convertTorquePrioToVishnuPrio (
\begin{DoxyParamCaption}
\item[{const int \&}]{prio}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classTorqueServer_a2427d2d3c69cf28f779d22396383e4d4}


Function to convert the Torque priority into VISHNU priority. 


\begin{DoxyParams}{Parameters}
{\em prio} & the priority to convert \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
VISHNU state 
\end{DoxyReturn}
\hypertarget{classTorqueServer_a5fb51c751187a2bd49598aee2b0e3b18}{
\index{TorqueServer@{TorqueServer}!convertTorqueStateToVishnuState@{convertTorqueStateToVishnuState}}
\index{convertTorqueStateToVishnuState@{convertTorqueStateToVishnuState}!TorqueServer@{TorqueServer}}
\subsubsection[{convertTorqueStateToVishnuState}]{\setlength{\rightskip}{0pt plus 5cm}int TorqueServer::convertTorqueStateToVishnuState (
\begin{DoxyParamCaption}
\item[{std::string}]{state}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classTorqueServer_a5fb51c751187a2bd49598aee2b0e3b18}


Function to convert the Torque state into VISHNU state. 


\begin{DoxyParams}{Parameters}
{\em state} & the state to convert \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
VISHNU state 
\end{DoxyReturn}
\hypertarget{classTorqueServer_a0411b4c5d842efabc66e9a5db39cceba}{
\index{TorqueServer@{TorqueServer}!fillJobInfo@{fillJobInfo}}
\index{fillJobInfo@{fillJobInfo}!TorqueServer@{TorqueServer}}
\subsubsection[{fillJobInfo}]{\setlength{\rightskip}{0pt plus 5cm}void TorqueServer::fillJobInfo (
\begin{DoxyParamCaption}
\item[{TMS\_\-Data::Job \&}]{job, }
\item[{struct batch\_\-status $\ast$}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classTorqueServer_a0411b4c5d842efabc66e9a5db39cceba}


Function To fill the info concerning a job. 


\begin{DoxyParams}{Parameters}
{\em job,:} & The job to fill \\
\hline
{\em p,:} & The batch status structure containing the job info \\
\hline
\end{DoxyParams}
\hypertarget{classTorqueServer_aa43c09a2a522df515a6b0b4334ed96d8}{
\index{TorqueServer@{TorqueServer}!getFormatedCpuPerNode@{getFormatedCpuPerNode}}
\index{getFormatedCpuPerNode@{getFormatedCpuPerNode}!TorqueServer@{TorqueServer}}
\subsubsection[{getFormatedCpuPerNode}]{\setlength{\rightskip}{0pt plus 5cm}std::string TorqueServer::getFormatedCpuPerNode (
\begin{DoxyParamCaption}
\item[{const int \&}]{cpu, }
\item[{const std::string \&}]{scriptPath}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classTorqueServer_aa43c09a2a522df515a6b0b4334ed96d8}


Function to get the torque formated cpu per node. 


\begin{DoxyParams}{Parameters}
{\em cpu} & The given cpu in string \\
\hline
{\em scriptPath} & The path of the script that enventually contain the node format or the number of node \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
formated cpu per node 
\end{DoxyReturn}
\hypertarget{classTorqueServer_accebe9545525e72a67d3c684665c9264}{
\index{TorqueServer@{TorqueServer}!getJobStartTime@{getJobStartTime}}
\index{getJobStartTime@{getJobStartTime}!TorqueServer@{TorqueServer}}
\subsubsection[{getJobStartTime}]{\setlength{\rightskip}{0pt plus 5cm}time\_\-t TorqueServer::getJobStartTime (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{jobId}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classTorqueServer_accebe9545525e72a67d3c684665c9264}


Function to get the start time of the job. 


\begin{DoxyParams}{Parameters}
{\em jobId} & the identifier of the job \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the job is unknown or server not unavailable 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_aa43eebf4a61d0d61646b7595630d2ef1}{BatchServer}.

\hypertarget{classTorqueServer_ab86efdba2c40900e858ebf9f687ad05b}{
\index{TorqueServer@{TorqueServer}!getJobState@{getJobState}}
\index{getJobState@{getJobState}!TorqueServer@{TorqueServer}}
\subsubsection[{getJobState}]{\setlength{\rightskip}{0pt plus 5cm}int TorqueServer::getJobState (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{jobId}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classTorqueServer_ab86efdba2c40900e858ebf9f687ad05b}


Function to get the status of the job. 


\begin{DoxyParams}{Parameters}
{\em jobId} & the identifier of the job \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/1 if the job is unknown or server not unavailable 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_ac82e407645e4ad185cf59edcee832d58}{BatchServer}.

\hypertarget{classTorqueServer_a3abd12ff06eb1774669d03b3f6f85f22}{
\index{TorqueServer@{TorqueServer}!getNbNodesInNodeFormat@{getNbNodesInNodeFormat}}
\index{getNbNodesInNodeFormat@{getNbNodesInNodeFormat}!TorqueServer@{TorqueServer}}
\subsubsection[{getNbNodesInNodeFormat}]{\setlength{\rightskip}{0pt plus 5cm}int TorqueServer::getNbNodesInNodeFormat (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{format, }
\item[{int \&}]{nbCpu}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classTorqueServer_a3abd12ff06eb1774669d03b3f6f85f22}


Function to get the number of nodes in the torque node format. 


\begin{DoxyParams}{Parameters}
{\em format} & The node format \\
\hline
{\em nbCpu} & The minimum number of cpu per node \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of node 
\end{DoxyReturn}
\hypertarget{classTorqueServer_a63240dcd85082bb88ee157a8da8f6a04}{
\index{TorqueServer@{TorqueServer}!listQueues@{listQueues}}
\index{listQueues@{listQueues}!TorqueServer@{TorqueServer}}
\subsubsection[{listQueues}]{\setlength{\rightskip}{0pt plus 5cm}TMS\_\-Data::ListQueues$\ast$ TorqueServer::listQueues (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{optQueueName = {\ttfamily std::string()}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classTorqueServer_a63240dcd85082bb88ee157a8da8f6a04}


Function to request the status of queues. 


\begin{DoxyParams}{Parameters}
{\em optQueueName} & (optional) the name of the queue to request \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The requested status in to ListQueues data structure 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_ab5cb2d2073b50e7c1f81693baed942ea}{BatchServer}.

\hypertarget{classTorqueServer_a8f155d04ceea433de756c98225c053b8}{
\index{TorqueServer@{TorqueServer}!pbs\_\-cancel@{pbs\_\-cancel}}
\index{pbs\_\-cancel@{pbs\_\-cancel}!TorqueServer@{TorqueServer}}
\subsubsection[{pbs\_\-cancel}]{\setlength{\rightskip}{0pt plus 5cm}int TorqueServer::pbs\_\-cancel (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{jobId, }
\item[{char}]{remoteServer\mbox{[}$\,$\mbox{]}, }
\item[{bool}]{isLocal = {\ttfamily true}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classTorqueServer_a8f155d04ceea433de756c98225c053b8}


Function to cancel job on remote machine. 


\begin{DoxyParams}{Parameters}
{\em jobId} & The identifier of the job \\
\hline
{\em remoteServer} & the name of the remote server \\
\hline
{\em isLocal} & is the remoteServer is local \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
raises an exception on error 
\end{DoxyReturn}
\hypertarget{classTorqueServer_a8c8357ec45741351b28891a01fd52a3b}{
\index{TorqueServer@{TorqueServer}!processOptions@{processOptions}}
\index{processOptions@{processOptions}!TorqueServer@{TorqueServer}}
\subsubsection[{processOptions}]{\setlength{\rightskip}{0pt plus 5cm}void TorqueServer::processOptions (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{scriptPath, }
\item[{const TMS\_\-Data::SubmitOptions \&}]{options, }
\item[{std::vector$<$ std::string $>$ \&}]{cmdsOptions}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classTorqueServer_a8c8357ec45741351b28891a01fd52a3b}


Function to treat the submission options. 


\begin{DoxyParams}{Parameters}
{\em scriptPath} & The job script path \\
\hline
{\em options} & the object which contains the SubmitOptions options values \\
\hline
{\em cmdsOptions} & The list of the option value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
raises an exception on error 
\end{DoxyReturn}
\hypertarget{classTorqueServer_aed03b8755d1959b3a2218abbf4c15b45}{
\index{TorqueServer@{TorqueServer}!submit@{submit}}
\index{submit@{submit}!TorqueServer@{TorqueServer}}
\subsubsection[{submit}]{\setlength{\rightskip}{0pt plus 5cm}int TorqueServer::submit (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{scriptPath, }
\item[{const TMS\_\-Data::SubmitOptions \&}]{options, }
\item[{TMS\_\-Data::Job \&}]{job, }
\item[{char $\ast$$\ast$}]{envp = {\ttfamily NULL}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classTorqueServer_aed03b8755d1959b3a2218abbf4c15b45}


Function to submit Torque job. 


\begin{DoxyParams}{Parameters}
{\em scriptPath} & the path to the script containing the job characteristique \\
\hline
{\em options} & the options to submit job \\
\hline
{\em job} & The job data structure \\
\hline
{\em envp} & The list of environment variables used by Torque submission function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
raises an exception on error 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_a078c0f8605e770c02b8eca0351526f59}{BatchServer}.



The documentation for this class was generated from the following file:\begin{DoxyCompactItemize}
\item 
TMS/src/server/\hyperlink{TorqueServer_8hpp}{TorqueServer.hpp}\end{DoxyCompactItemize}
