\hypertarget{classSlurmServer}{
\section{SlurmServer Class Reference}
\label{classSlurmServer}\index{SlurmServer@{SlurmServer}}
}


\hyperlink{classSlurmServer}{SlurmServer} class implementation.  




{\ttfamily \#include $<$SlurmServer.hpp$>$}

Inheritance diagram for SlurmServer:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classSlurmServer}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classSlurmServer_a451ef6b48bbd0a0335a2f82790f42988}{
\hyperlink{classSlurmServer_a451ef6b48bbd0a0335a2f82790f42988}{SlurmServer} ()}
\label{classSlurmServer_a451ef6b48bbd0a0335a2f82790f42988}

\begin{DoxyCompactList}\small\item\em Constructor. \item\end{DoxyCompactList}\item 
int \hyperlink{classSlurmServer_a351897c7bb3d2b1810cb6ea0bee6262b}{submit} (const char $\ast$scriptPath, const TMS\_\-Data::SubmitOptions \&options, TMS\_\-Data::Job \&job, char $\ast$$\ast$envp=NULL)
\begin{DoxyCompactList}\small\item\em Function to submit Slurm job. \item\end{DoxyCompactList}\item 
int \hyperlink{classSlurmServer_a5965b0689881cee596641c47135357e7}{cancel} (const char $\ast$jobId)
\begin{DoxyCompactList}\small\item\em Function to cancel job. \item\end{DoxyCompactList}\item 
int \hyperlink{classSlurmServer_ac0466b9e8159a2b3e963ab274c00da1d}{getJobState} (const std::string \&jobId)
\begin{DoxyCompactList}\small\item\em Function to get the status of the job. \item\end{DoxyCompactList}\item 
time\_\-t \hyperlink{classSlurmServer_a85aab0d27ed279c3696a033ddf1a05bf}{getJobStartTime} (const std::string \&jobId)
\begin{DoxyCompactList}\small\item\em Function to get the start time of the job. \item\end{DoxyCompactList}\item 
TMS\_\-Data::ListQueues $\ast$ \hyperlink{classSlurmServer_a363bf0b22c519039244f6bc938577e9c}{listQueues} (const std::string \&optQueueName=std::string())
\begin{DoxyCompactList}\small\item\em Function to request the status of queues. \item\end{DoxyCompactList}\item 
\hypertarget{classSlurmServer_aa7ff9a60deb4bca42bb39d0c5d98daa3}{
\hyperlink{classSlurmServer_aa7ff9a60deb4bca42bb39d0c5d98daa3}{$\sim$SlurmServer} ()}
\label{classSlurmServer_aa7ff9a60deb4bca42bb39d0c5d98daa3}

\begin{DoxyCompactList}\small\item\em Destructor. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classSlurmServer_a04c8991b630a2b23d0da7a9814bcae47}{processOptions} (const TMS\_\-Data::SubmitOptions \&options, std::vector$<$ std::string $>$ \&cmdsOptions)
\begin{DoxyCompactList}\small\item\em Function to treat the submission options. \item\end{DoxyCompactList}\item 
int \hyperlink{classSlurmServer_a294e9fcc0e094584645838773a5f454e}{convertSlurmStateToVishnuState} (const uint16\_\-t \&state)
\begin{DoxyCompactList}\small\item\em Function to convert the Slurm state into VISHNU state. \item\end{DoxyCompactList}\item 
int \hyperlink{classSlurmServer_a307212f4e936651b7c9f98c6878ff94c}{convertSlurmPrioToVishnuPrio} (const uint32\_\-t \&prio)
\begin{DoxyCompactList}\small\item\em Function to convert the Slurm priority into VISHNU priority. \item\end{DoxyCompactList}\item 
void \hyperlink{classSlurmServer_a0dbf7a58ec3a83676a09c4c74e858467}{fillJobInfo} (TMS\_\-Data::Job \&job, const uint32\_\-t \&jobId)
\begin{DoxyCompactList}\small\item\em Function To fill the info concerning a job. \item\end{DoxyCompactList}\item 
uint32\_\-t \hyperlink{classSlurmServer_a395cdd78cbe080d1834b403f3712402a}{convertToSlurmJobId} (const std::string \&jobId)
\begin{DoxyCompactList}\small\item\em Function To convert vishnu job Id to slurm job Id. \item\end{DoxyCompactList}\item 
int \hyperlink{classSlurmServer_a2b7eabbb5025b76e1828001d946a267e}{computeNbRunJobsAndQueueJobs} (std::map$<$ std::string, size\_\-t $>$ \&run, std::map$<$ std::string, size\_\-t $>$ \&que)
\begin{DoxyCompactList}\small\item\em Function to compute the number of running and waiting jobs of each queue. \item\end{DoxyCompactList}\item 
void \hyperlink{classSlurmServer_a27e52d883798ce8ba9d341da69364245}{replaceSymbolInToJobPath} (std::string \&path)
\begin{DoxyCompactList}\small\item\em Function to replace slurm job identifer symbol by its real value in to a path. \item\end{DoxyCompactList}\item 
bool \hyperlink{classSlurmServer_a81c65cc4a6b83c291b5ec2c8ca028169}{containsAnExcludedSlurmSymbols} (const std::string \&path, std::string \&symbol)
\begin{DoxyCompactList}\small\item\em Function to cheick if a path contains an excluded slurm symbol by vishnu. \item\end{DoxyCompactList}\item 
std::string \hyperlink{classSlurmServer_a6c33cb8cae0ca873cd8b59fe5df85634}{checkSLURMOutPutPath} (char $\ast$\&path, const std::string \&pathInfo=\char`\"{}job output path\char`\"{})
\begin{DoxyCompactList}\small\item\em Function to check if slurm path syntax is correct. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classSlurmServer_ad6eff756bf514fdd864f438d9f316753}{
TMS\_\-Data::ListQueues\_\-ptr \hyperlink{classSlurmServer_ad6eff756bf514fdd864f438d9f316753}{mlistQueues}}
\label{classSlurmServer_ad6eff756bf514fdd864f438d9f316753}

\begin{DoxyCompactList}\small\item\em ListQueues returned. \item\end{DoxyCompactList}\item 
\hypertarget{classSlurmServer_ac2398fd17afe409085e6f0f116c2ed2b}{
std::map$<$ std::string, std::string $>$ \hyperlink{classSlurmServer_ac2398fd17afe409085e6f0f116c2ed2b}{msymbolMap}}
\label{classSlurmServer_ac2398fd17afe409085e6f0f116c2ed2b}

\begin{DoxyCompactList}\small\item\em msymbolMap contains the slurm partern symbols of job output and error path \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
\hyperlink{classSlurmServer}{SlurmServer} class implementation. 

\subsection{Member Function Documentation}
\hypertarget{classSlurmServer_a5965b0689881cee596641c47135357e7}{
\index{SlurmServer@{SlurmServer}!cancel@{cancel}}
\index{cancel@{cancel}!SlurmServer@{SlurmServer}}
\subsubsection[{cancel}]{\setlength{\rightskip}{0pt plus 5cm}int SlurmServer::cancel (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{ jobId}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSlurmServer_a5965b0689881cee596641c47135357e7}


Function to cancel job. 


\begin{DoxyParams}{Parameters}
\item[{\em jobId}]the identifier of the job to cancel \end{DoxyParams}
\begin{DoxyReturn}{Returns}
raises an exception on error 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_af40bbd83fa2bd1f1720e29800227cdb0}{BatchServer}.

\hypertarget{classSlurmServer_a6c33cb8cae0ca873cd8b59fe5df85634}{
\index{SlurmServer@{SlurmServer}!checkSLURMOutPutPath@{checkSLURMOutPutPath}}
\index{checkSLURMOutPutPath@{checkSLURMOutPutPath}!SlurmServer@{SlurmServer}}
\subsubsection[{checkSLURMOutPutPath}]{\setlength{\rightskip}{0pt plus 5cm}std::string SlurmServer::checkSLURMOutPutPath (
\begin{DoxyParamCaption}
\item[{char $\ast$\&}]{ path, }
\item[{const std::string \&}]{ pathInfo = {\ttfamily \char`\"{}job~output~path\char`\"{}}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a6c33cb8cae0ca873cd8b59fe5df85634}


Function to check if slurm path syntax is correct. 


\begin{DoxyParams}{Parameters}
\item[{\em path}]the path to check \item[{\em pathInfo}]The information on path to print \end{DoxyParams}
\begin{DoxyReturn}{Returns}
an error message 
\end{DoxyReturn}
\hypertarget{classSlurmServer_a2b7eabbb5025b76e1828001d946a267e}{
\index{SlurmServer@{SlurmServer}!computeNbRunJobsAndQueueJobs@{computeNbRunJobsAndQueueJobs}}
\index{computeNbRunJobsAndQueueJobs@{computeNbRunJobsAndQueueJobs}!SlurmServer@{SlurmServer}}
\subsubsection[{computeNbRunJobsAndQueueJobs}]{\setlength{\rightskip}{0pt plus 5cm}int SlurmServer::computeNbRunJobsAndQueueJobs (
\begin{DoxyParamCaption}
\item[{std::map$<$ std::string, size\_\-t $>$ \&}]{ run, }
\item[{std::map$<$ std::string, size\_\-t $>$ \&}]{ que}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a2b7eabbb5025b76e1828001d946a267e}


Function to compute the number of running and waiting jobs of each queue. 


\begin{DoxyParams}{Parameters}
\item[{\em run}]contains the number of running jobs of each queue \item[{\em que}]contains the number of waiting jobs of each queue \end{DoxyParams}
\begin{DoxyReturn}{Returns}
non zero if error 
\end{DoxyReturn}
\hypertarget{classSlurmServer_a81c65cc4a6b83c291b5ec2c8ca028169}{
\index{SlurmServer@{SlurmServer}!containsAnExcludedSlurmSymbols@{containsAnExcludedSlurmSymbols}}
\index{containsAnExcludedSlurmSymbols@{containsAnExcludedSlurmSymbols}!SlurmServer@{SlurmServer}}
\subsubsection[{containsAnExcludedSlurmSymbols}]{\setlength{\rightskip}{0pt plus 5cm}bool SlurmServer::containsAnExcludedSlurmSymbols (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{ path, }
\item[{std::string \&}]{ symbol}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a81c65cc4a6b83c291b5ec2c8ca028169}


Function to cheick if a path contains an excluded slurm symbol by vishnu. 


\begin{DoxyParams}{Parameters}
\item[{\em path}]The path to check \item[{\em symbol}]The excluded symbol \end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if the path contain an exlude symbol 
\end{DoxyReturn}
\hypertarget{classSlurmServer_a307212f4e936651b7c9f98c6878ff94c}{
\index{SlurmServer@{SlurmServer}!convertSlurmPrioToVishnuPrio@{convertSlurmPrioToVishnuPrio}}
\index{convertSlurmPrioToVishnuPrio@{convertSlurmPrioToVishnuPrio}!SlurmServer@{SlurmServer}}
\subsubsection[{convertSlurmPrioToVishnuPrio}]{\setlength{\rightskip}{0pt plus 5cm}int SlurmServer::convertSlurmPrioToVishnuPrio (
\begin{DoxyParamCaption}
\item[{const uint32\_\-t \&}]{ prio}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a307212f4e936651b7c9f98c6878ff94c}


Function to convert the Slurm priority into VISHNU priority. 


\begin{DoxyParams}{Parameters}
\item[{\em prio}]the priority to convert \end{DoxyParams}
\begin{DoxyReturn}{Returns}
VISHNU state 
\end{DoxyReturn}
\hypertarget{classSlurmServer_a294e9fcc0e094584645838773a5f454e}{
\index{SlurmServer@{SlurmServer}!convertSlurmStateToVishnuState@{convertSlurmStateToVishnuState}}
\index{convertSlurmStateToVishnuState@{convertSlurmStateToVishnuState}!SlurmServer@{SlurmServer}}
\subsubsection[{convertSlurmStateToVishnuState}]{\setlength{\rightskip}{0pt plus 5cm}int SlurmServer::convertSlurmStateToVishnuState (
\begin{DoxyParamCaption}
\item[{const uint16\_\-t \&}]{ state}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a294e9fcc0e094584645838773a5f454e}


Function to convert the Slurm state into VISHNU state. 


\begin{DoxyParams}{Parameters}
\item[{\em state}]the state to convert \end{DoxyParams}
\begin{DoxyReturn}{Returns}
VISHNU state 
\end{DoxyReturn}
\hypertarget{classSlurmServer_a395cdd78cbe080d1834b403f3712402a}{
\index{SlurmServer@{SlurmServer}!convertToSlurmJobId@{convertToSlurmJobId}}
\index{convertToSlurmJobId@{convertToSlurmJobId}!SlurmServer@{SlurmServer}}
\subsubsection[{convertToSlurmJobId}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t SlurmServer::convertToSlurmJobId (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{ jobId}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a395cdd78cbe080d1834b403f3712402a}


Function To convert vishnu job Id to slurm job Id. 


\begin{DoxyParams}{Parameters}
\item[{\em jobId,:}]vishnu job Id \end{DoxyParams}
\begin{DoxyReturn}{Returns}
the converted slurm job id 
\end{DoxyReturn}
\hypertarget{classSlurmServer_a0dbf7a58ec3a83676a09c4c74e858467}{
\index{SlurmServer@{SlurmServer}!fillJobInfo@{fillJobInfo}}
\index{fillJobInfo@{fillJobInfo}!SlurmServer@{SlurmServer}}
\subsubsection[{fillJobInfo}]{\setlength{\rightskip}{0pt plus 5cm}void SlurmServer::fillJobInfo (
\begin{DoxyParamCaption}
\item[{TMS\_\-Data::Job \&}]{ job, }
\item[{const uint32\_\-t \&}]{ jobId}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a0dbf7a58ec3a83676a09c4c74e858467}


Function To fill the info concerning a job. 


\begin{DoxyParams}{Parameters}
\item[{\em job,:}]The job to fill \item[{\em jobId,:}]The identifier of the job to load \end{DoxyParams}
\hypertarget{classSlurmServer_a85aab0d27ed279c3696a033ddf1a05bf}{
\index{SlurmServer@{SlurmServer}!getJobStartTime@{getJobStartTime}}
\index{getJobStartTime@{getJobStartTime}!SlurmServer@{SlurmServer}}
\subsubsection[{getJobStartTime}]{\setlength{\rightskip}{0pt plus 5cm}time\_\-t SlurmServer::getJobStartTime (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{ jobId}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSlurmServer_a85aab0d27ed279c3696a033ddf1a05bf}


Function to get the start time of the job. 


\begin{DoxyParams}{Parameters}
\item[{\em jobId}]the identifier of the job \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if the job is unknown 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_aa43eebf4a61d0d61646b7595630d2ef1}{BatchServer}.

\hypertarget{classSlurmServer_ac0466b9e8159a2b3e963ab274c00da1d}{
\index{SlurmServer@{SlurmServer}!getJobState@{getJobState}}
\index{getJobState@{getJobState}!SlurmServer@{SlurmServer}}
\subsubsection[{getJobState}]{\setlength{\rightskip}{0pt plus 5cm}int SlurmServer::getJobState (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{ jobId}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSlurmServer_ac0466b9e8159a2b3e963ab274c00da1d}


Function to get the status of the job. 


\begin{DoxyParams}{Parameters}
\item[{\em jobId}]the identifier of the job \end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/1 if the job is unknown or server not unavailable 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_ac82e407645e4ad185cf59edcee832d58}{BatchServer}.

\hypertarget{classSlurmServer_a363bf0b22c519039244f6bc938577e9c}{
\index{SlurmServer@{SlurmServer}!listQueues@{listQueues}}
\index{listQueues@{listQueues}!SlurmServer@{SlurmServer}}
\subsubsection[{listQueues}]{\setlength{\rightskip}{0pt plus 5cm}TMS\_\-Data::ListQueues$\ast$ SlurmServer::listQueues (
\begin{DoxyParamCaption}
\item[{const std::string \&}]{ optQueueName = {\ttfamily std::string()}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSlurmServer_a363bf0b22c519039244f6bc938577e9c}


Function to request the status of queues. 


\begin{DoxyParams}{Parameters}
\item[{\em optQueueName}](optional) the name of the queue to request \end{DoxyParams}
\begin{DoxyReturn}{Returns}
The requested status in to ListQueues data structure 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_ab5cb2d2073b50e7c1f81693baed942ea}{BatchServer}.

\hypertarget{classSlurmServer_a04c8991b630a2b23d0da7a9814bcae47}{
\index{SlurmServer@{SlurmServer}!processOptions@{processOptions}}
\index{processOptions@{processOptions}!SlurmServer@{SlurmServer}}
\subsubsection[{processOptions}]{\setlength{\rightskip}{0pt plus 5cm}void SlurmServer::processOptions (
\begin{DoxyParamCaption}
\item[{const TMS\_\-Data::SubmitOptions \&}]{ options, }
\item[{std::vector$<$ std::string $>$ \&}]{ cmdsOptions}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a04c8991b630a2b23d0da7a9814bcae47}


Function to treat the submission options. 


\begin{DoxyParams}{Parameters}
\item[{\em options}]the object which contains the SubmitOptions options values \item[{\em cmdsOptions}]The list of the option value \end{DoxyParams}
\begin{DoxyReturn}{Returns}
raises an exception on error 
\end{DoxyReturn}
\hypertarget{classSlurmServer_a27e52d883798ce8ba9d341da69364245}{
\index{SlurmServer@{SlurmServer}!replaceSymbolInToJobPath@{replaceSymbolInToJobPath}}
\index{replaceSymbolInToJobPath@{replaceSymbolInToJobPath}!SlurmServer@{SlurmServer}}
\subsubsection[{replaceSymbolInToJobPath}]{\setlength{\rightskip}{0pt plus 5cm}void SlurmServer::replaceSymbolInToJobPath (
\begin{DoxyParamCaption}
\item[{std::string \&}]{ path}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSlurmServer_a27e52d883798ce8ba9d341da69364245}


Function to replace slurm job identifer symbol by its real value in to a path. 


\begin{DoxyParams}{Parameters}
\item[{\em path}]The path containing the job symbol \end{DoxyParams}
\hypertarget{classSlurmServer_a351897c7bb3d2b1810cb6ea0bee6262b}{
\index{SlurmServer@{SlurmServer}!submit@{submit}}
\index{submit@{submit}!SlurmServer@{SlurmServer}}
\subsubsection[{submit}]{\setlength{\rightskip}{0pt plus 5cm}int SlurmServer::submit (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{ scriptPath, }
\item[{const TMS\_\-Data::SubmitOptions \&}]{ options, }
\item[{TMS\_\-Data::Job \&}]{ job, }
\item[{char $\ast$$\ast$}]{ envp = {\ttfamily NULL}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSlurmServer_a351897c7bb3d2b1810cb6ea0bee6262b}


Function to submit Slurm job. 


\begin{DoxyParams}{Parameters}
\item[{\em scriptPath}]the path to the script containing the job characteristique \item[{\em options}]the options to submit job \item[{\em job}]The job data structure \item[{\em envp}]The list of environment variables used by Slurm submission function \end{DoxyParams}
\begin{DoxyReturn}{Returns}
raises an exception on error 
\end{DoxyReturn}


Implements \hyperlink{classBatchServer_a078c0f8605e770c02b8eca0351526f59}{BatchServer}.



The documentation for this class was generated from the following file:\begin{DoxyCompactItemize}
\item 
TMS/src/server/\hyperlink{SlurmServer_8hpp}{SlurmServer.hpp}\end{DoxyCompactItemize}
